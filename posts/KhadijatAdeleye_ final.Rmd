---
title: "Untitled"
server: shiny
---
```{r}
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)
library(tidyverse)
install.packages("haven")
library(haven)
install.packages("devtools")
install.packages('rlang')
library(ggplot2)
install.packages("scales")
library(lubridate)
library(dplyr)
```


#INTRODUCTION
This paper will explores the  relationship between social capital and adherence among women living with HIV in a community with High HIV prevalence rate.The paper specific objective is the factors influencing adherence to ante-retro viral medication. The paper will begin with a brief introduction of the dataset and a resulting tidy data part. In the third section, the paper will explore the clean data through visualization in order to answer a set of questions: what is the level of ante-retroviral medication adherence among women living with HIV? Is there an association between social capital  and adherence to ante-retroviral medication?  The final part will reflect the limits of dataset and the process as the project unfolds along with a preliminary conclusion on the project.
```{r}
compliances_df <- read_dta('./Adherence at postpartum (1).dta')
```
```{r}
view(compliances_df)
```
## DATASET DESCRIPTION.
This is a data retrieved from women living with HIV on their social wellbeing, social capital and adherence to anteretroviral medications.The dataset has 165 column and 485 rows. To determine the relationship between adherence and controlling variable. So I reorganize the dataset. I first use the “select’’ function to create a dataset covering all”adherence” questions. Then, I create another dataset containing all controlling variable (age, marital status, level of education, smoking, year of disclosure).

```{r}
colnames(compliances_df)
```


#creating New dataset


```{r}
social_capital<-compliances_df%>%
  select(ifnodoyoureceivesupportfromfrien,workstatusoverthepast12months,meetwithfriendsrelativesorworkco,haveaclosefriend,stopandtalkwithpeopleinneighbour,socialnetworkgroup,satifiedwithfamilylife,satisfiedwithsociallife,relyonfriendandfamilyifIhaveaser,givespecialhelptoatleastonesickd,borrowthingsandexchangefavourswi)%>%
  n_distinct
```

```{r}
compliances_df%>%
  group_by(Age)%>%
  count(Aherence)
```


```{r}
clean_compliance_df<-select(compliances_df,Age,Education, MaritalStatus,Year_diagnosed,Aherence, Smokinh_recode, Disclosed)
```

```{r} 
dim(clean_compliance_df)
```
# list of column
```{r}
list(colnames(clean_compliance_df))
```

#Number of rows
```{r}
n_rows <- nrow(clean_compliance_df)
print(n_rows)
```


#Check for missing value
```{r}
sum(is.na(clean_compliance_df))
```
#There was one null value in the new dataset on the education index, which was dropped.
```{r}
na_cols <- which(colSums(is.na(clean_compliance_df)) > 0)
print(na_cols)
```
```{r}
clean_df <- na.omit(clean_compliance_df)
```

```{r}
sum(is.na(clean_df))
```


```{r}
str(clean_df)
```




#DATA ViSUALIZATION

```{r}
# create a bar plot for age and marital status
ggplot(data = clean_df, aes(x = Age, fill = MaritalStatus)) +
  geom_bar(position = "dodge", stat = "count") +
  labs(title = "Age and MaritalStatus",
       x = "Age",
       y = "Count",
       fill = "MaritalStatus")
```


```{r}
clean_df %>%
  ggplot(aes(Aherence,"Maritalstatus",))+
  geom_point()+
  facet_wrap(vars("Maritalstatus"))
```

```{r}
clean_df %>%
  ggplot(aes("Aherence", Year_diagnosed))+
  geom_point()
```
```{r}
bar_adherence <- clean_df %>%
  ggplot(mapping = aes(x = `Aherence`, fill =Disclosed),position = "fill") + 
  geom_bar()+
   labs(x="Aherence",y="Disclosed", title = "Adherence per dislosure") 
bar_adherence
```

`
