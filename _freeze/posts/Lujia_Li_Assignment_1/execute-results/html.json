{
  "hash": "aa1bdba8eeff3116d0373a1ce4422314",
  "result": {
    "markdown": "---\ntitle: \"Real Estate Data Analysis\"\nauthor: \"Lujia Li\"\ndesription: \"601 Assigment #1\"\ndate: \"05/03/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - Assignment 1\n  - Lujia Li\n  - NeighborhoodSales Summary\n  - ggplot2\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# read dataset\nlibrary(readxl)\nlibrary(dbplyr)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.1     ✔ purrr   1.0.1\n✔ tibble  3.1.8     ✔ dplyr   1.1.0\n✔ tidyr   1.3.0     ✔ stringr 1.5.0\n✔ readr   2.1.4     ✔ forcats 1.0.0\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::ident()  masks dbplyr::ident()\n✖ dplyr::lag()    masks stats::lag()\n✖ dplyr::sql()    masks dbplyr::sql()\n```\n:::\n\n```{.r .cell-code}\nbrooklyn2019 <- read_excel('Assignment_1_LujiaLi_folder/2019_brooklyn.xlsx', skip = 6)\nhead(brooklyn2019)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 21\n  `BOROUGH\\r\\n` NEIGHB…¹ BUILD…² TAX C…³ BLOCK…⁴ LOT\\r…⁵ EASE-…⁶ BUILD…⁷ ADDRE…⁸\n  <chr>         <chr>    <chr>   <chr>     <dbl>   <dbl> <lgl>   <chr>   <chr>  \n1 3             BATH BE… 01 ONE… 1          6363      22 NA      A9      8645 1…\n2 3             BATH BE… 01 ONE… 1          6363      48 NA      A9      12 BAY…\n3 3             BATH BE… 01 ONE… 1          6363      48 NA      A9      12 BAY…\n4 3             BATH BE… 01 ONE… 1          6364      74 NA      A5      72 BAY…\n5 3             BATH BE… 01 ONE… 1          6367      42 NA      S1      1730 8…\n6 3             BATH BE… 01 ONE… 1          6367      43 NA      S1      1732 8…\n# … with 12 more variables: `APARTMENT NUMBER\\r\\n` <chr>, `ZIP CODE\\r\\n` <dbl>,\n#   `RESIDENTIAL UNITS\\r\\n` <dbl>, `COMMERCIAL UNITS\\r\\n` <dbl>,\n#   `TOTAL UNITS\\r\\n` <dbl>, `LAND SQUARE FEET\\r\\n` <dbl>,\n#   `GROSS SQUARE FEET\\r\\n` <dbl>, `YEAR BUILT\\r\\n` <dbl>,\n#   `TAX CLASS AT TIME OF SALE\\r\\n` <chr>,\n#   `BUILDING CLASS AT TIME OF SALE\\r\\n` <chr>, `SALE PRICE\\r\\n` <dbl>,\n#   `SALE DATE\\r\\n` <dttm>, and abbreviated variable names …\n```\n:::\n\n```{.r .cell-code}\n# dimension of dataset\ndim(brooklyn2019)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 23276    21\n```\n:::\n\n```{.r .cell-code}\n# variables/column names\ncolnames(brooklyn2019)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"BOROUGH\\r\\n\"                          \n [2] \"NEIGHBORHOOD\\r\\n\"                     \n [3] \"BUILDING CLASS CATEGORY\\r\\n\"          \n [4] \"TAX CLASS AS OF FINAL ROLL 18/19\"     \n [5] \"BLOCK\\r\\n\"                            \n [6] \"LOT\\r\\n\"                              \n [7] \"EASE-MENT\\r\\n\"                        \n [8] \"BUILDING CLASS AS OF FINAL ROLL 18/19\"\n [9] \"ADDRESS\\r\\n\"                          \n[10] \"APARTMENT NUMBER\\r\\n\"                 \n[11] \"ZIP CODE\\r\\n\"                         \n[12] \"RESIDENTIAL UNITS\\r\\n\"                \n[13] \"COMMERCIAL UNITS\\r\\n\"                 \n[14] \"TOTAL UNITS\\r\\n\"                      \n[15] \"LAND SQUARE FEET\\r\\n\"                 \n[16] \"GROSS SQUARE FEET\\r\\n\"                \n[17] \"YEAR BUILT\\r\\n\"                       \n[18] \"TAX CLASS AT TIME OF SALE\\r\\n\"        \n[19] \"BUILDING CLASS AT TIME OF SALE\\r\\n\"   \n[20] \"SALE PRICE\\r\\n\"                       \n[21] \"SALE DATE\\r\\n\"                        \n```\n:::\n\n```{.r .cell-code}\n# remove the special characters in variables\ncolnames(brooklyn2019) <- colnames(brooklyn2019) %>% \n  gsub(\"\\r\", \"\", .) %>%    # delete the special character \"\\r\" in variables\n  gsub(\"\\n\", \" \", .) %>%   # replace the special character \"\\n\" with space in variables\n  gsub(\" $\", \"\",. , perl = T) %>%  # delete the space at the end of variables\n  gsub(\"  \", \" \",. , perl = T)  # replace the double spaces with single space in variables\ncolnames(brooklyn2019)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"BOROUGH\"                              \n [2] \"NEIGHBORHOOD\"                         \n [3] \"BUILDING CLASS CATEGORY\"              \n [4] \"TAX CLASS AS OF FINAL ROLL 18/19\"     \n [5] \"BLOCK\"                                \n [6] \"LOT\"                                  \n [7] \"EASE-MENT\"                            \n [8] \"BUILDING CLASS AS OF FINAL ROLL 18/19\"\n [9] \"ADDRESS\"                              \n[10] \"APARTMENT NUMBER\"                     \n[11] \"ZIP CODE\"                             \n[12] \"RESIDENTIAL UNITS\"                    \n[13] \"COMMERCIAL UNITS\"                     \n[14] \"TOTAL UNITS\"                          \n[15] \"LAND SQUARE FEET\"                     \n[16] \"GROSS SQUARE FEET\"                    \n[17] \"YEAR BUILT\"                           \n[18] \"TAX CLASS AT TIME OF SALE\"            \n[19] \"BUILDING CLASS AT TIME OF SALE\"       \n[20] \"SALE PRICE\"                           \n[21] \"SALE DATE\"                            \n```\n:::\n\n```{.r .cell-code}\n# remove duplicated rows in dataset\nbrooklyn2019 <- distinct(brooklyn2019)\nstr(brooklyn2019)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [23,252 × 21] (S3: tbl_df/tbl/data.frame)\n $ BOROUGH                              : chr [1:23252] \"3\" \"3\" \"3\" \"3\" ...\n $ NEIGHBORHOOD                         : chr [1:23252] \"BATH BEACH\" \"BATH BEACH\" \"BATH BEACH\" \"BATH BEACH\" ...\n $ BUILDING CLASS CATEGORY              : chr [1:23252] \"01 ONE FAMILY DWELLINGS\" \"01 ONE FAMILY DWELLINGS\" \"01 ONE FAMILY DWELLINGS\" \"01 ONE FAMILY DWELLINGS\" ...\n $ TAX CLASS AS OF FINAL ROLL 18/19     : chr [1:23252] \"1\" \"1\" \"1\" \"1\" ...\n $ BLOCK                                : num [1:23252] 6363 6363 6363 6364 6367 ...\n $ LOT                                  : num [1:23252] 22 48 48 74 42 43 66 66 32 20 ...\n $ EASE-MENT                            : logi [1:23252] NA NA NA NA NA NA ...\n $ BUILDING CLASS AS OF FINAL ROLL 18/19: chr [1:23252] \"A9\" \"A9\" \"A9\" \"A5\" ...\n $ ADDRESS                              : chr [1:23252] \"8645 16TH AVENUE\" \"12 BAY 13TH STREET\" \"12 BAY 13TH STREET\" \"72 BAY 14TH STREET\" ...\n $ APARTMENT NUMBER                     : chr [1:23252] NA NA NA NA ...\n $ ZIP CODE                             : num [1:23252] 11214 11214 11214 11214 11214 ...\n $ RESIDENTIAL UNITS                    : num [1:23252] 1 1 1 1 1 1 1 1 1 1 ...\n $ COMMERCIAL UNITS                     : num [1:23252] 0 0 0 0 1 1 0 0 0 0 ...\n $ TOTAL UNITS                          : num [1:23252] 1 1 1 1 2 2 1 1 1 1 ...\n $ LAND SQUARE FEET                     : num [1:23252] 2058 3142 3142 2492 1342 ...\n $ GROSS SQUARE FEET                    : num [1:23252] 1492 3200 3200 972 1920 ...\n $ YEAR BUILT                           : num [1:23252] 1930 1999 1999 1950 1926 ...\n $ TAX CLASS AT TIME OF SALE            : chr [1:23252] \"1\" \"1\" \"1\" \"1\" ...\n $ BUILDING CLASS AT TIME OF SALE       : chr [1:23252] \"A9\" \"A9\" \"A9\" \"A5\" ...\n $ SALE PRICE                           : num [1:23252] 0 0 0 0 1630000 1630000 0 0 1200000 0 ...\n $ SALE DATE                            : POSIXct[1:23252], format: \"2019-04-23\" \"2019-02-27\" ...\n```\n:::\n\n```{.r .cell-code}\n# subset dataset\n# c('BOROUGH','RESIDENTIAL UNITS','COMMERCIAL UNITS','TOTAL UNITS','LAND SQUARE FEET','GROSS SQUARE FEET',\n#   'YEAR BUILT','BUILDING CLASS AT TIME OF SALE','SALE PRICE','SALE DATE') %>%\n#    subset(brooklyn2019, select = .) -> selected_brooklyn2019\n\nselected_brooklyn2019 <- subset(brooklyn2019, select = c('BOROUGH','RESIDENTIAL UNITS','COMMERCIAL UNITS','TOTAL UNITS','LAND SQUARE FEET','GROSS SQUARE FEET',\n  'YEAR BUILT','BUILDING CLASS AT TIME OF SALE','SALE PRICE','SALE DATE'))\n\nstr(selected_brooklyn2019)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [23,252 × 10] (S3: tbl_df/tbl/data.frame)\n $ BOROUGH                       : chr [1:23252] \"3\" \"3\" \"3\" \"3\" ...\n $ RESIDENTIAL UNITS             : num [1:23252] 1 1 1 1 1 1 1 1 1 1 ...\n $ COMMERCIAL UNITS              : num [1:23252] 0 0 0 0 1 1 0 0 0 0 ...\n $ TOTAL UNITS                   : num [1:23252] 1 1 1 1 2 2 1 1 1 1 ...\n $ LAND SQUARE FEET              : num [1:23252] 2058 3142 3142 2492 1342 ...\n $ GROSS SQUARE FEET             : num [1:23252] 1492 3200 3200 972 1920 ...\n $ YEAR BUILT                    : num [1:23252] 1930 1999 1999 1950 1926 ...\n $ BUILDING CLASS AT TIME OF SALE: chr [1:23252] \"A9\" \"A9\" \"A9\" \"A5\" ...\n $ SALE PRICE                    : num [1:23252] 0 0 0 0 1630000 1630000 0 0 1200000 0 ...\n $ SALE DATE                     : POSIXct[1:23252], format: \"2019-04-23\" \"2019-02-27\" ...\n```\n:::\n\n```{.r .cell-code}\n# count the number and calculate the percentage of NA values\nNumNA_column <- function(x){sum(is.na(x))} # function to count the number of NA values\napply(selected_brooklyn2019, 2, NumNA_column)   # number of NA in each column\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                       BOROUGH              RESIDENTIAL UNITS \n                             0                           2630 \n              COMMERCIAL UNITS                    TOTAL UNITS \n                          2630                           2630 \n              LAND SQUARE FEET              GROSS SQUARE FEET \n                          2630                           2630 \n                    YEAR BUILT BUILDING CLASS AT TIME OF SALE \n                          1600                              0 \n                    SALE PRICE                      SALE DATE \n                             0                              0 \n```\n:::\n\n```{.r .cell-code}\nPercentageNA_column <- function(x){sum(is.na(x))/length(x)*100}\napply(selected_brooklyn2019, 2, PercentageNA_column) # percentage of NA in each column\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                       BOROUGH              RESIDENTIAL UNITS \n                      0.000000                      11.310855 \n              COMMERCIAL UNITS                    TOTAL UNITS \n                     11.310855                      11.310855 \n              LAND SQUARE FEET              GROSS SQUARE FEET \n                     11.310855                      11.310855 \n                    YEAR BUILT BUILDING CLASS AT TIME OF SALE \n                      6.881129                       0.000000 \n                    SALE PRICE                      SALE DATE \n                      0.000000                       0.000000 \n```\n:::\n\n```{.r .cell-code}\n# count the number of 0 sales price\n# 0 sale price means that a transfer of ownership without a cash consideration\ntable(selected_brooklyn2019$`SALE PRICE` == 0)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nFALSE  TRUE \n15019  8233 \n```\n:::\n\n```{.r .cell-code}\nprop.table(table(selected_brooklyn2019$`SALE PRICE` == 0))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n    FALSE      TRUE \n0.6459229 0.3540771 \n```\n:::\n\n```{.r .cell-code}\n# remove rows with NA values and 0 sale price\n# 0 sale price means that a transfer of ownership without a cash consideration\nnew_brooklyn2019 <- na.omit(selected_brooklyn2019) %>% # delete rows with NA values\n  filter(., 'SALE PRICE' != 0)     # select rows with non-zero sale price\nstr(new_brooklyn2019)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [19,028 × 10] (S3: tbl_df/tbl/data.frame)\n $ BOROUGH                       : chr [1:19028] \"3\" \"3\" \"3\" \"3\" ...\n $ RESIDENTIAL UNITS             : num [1:19028] 1 1 1 1 1 1 1 1 1 1 ...\n $ COMMERCIAL UNITS              : num [1:19028] 0 0 0 0 1 1 0 0 0 0 ...\n $ TOTAL UNITS                   : num [1:19028] 1 1 1 1 2 2 1 1 1 1 ...\n $ LAND SQUARE FEET              : num [1:19028] 2058 3142 3142 2492 1342 ...\n $ GROSS SQUARE FEET             : num [1:19028] 1492 3200 3200 972 1920 ...\n $ YEAR BUILT                    : num [1:19028] 1930 1999 1999 1950 1926 ...\n $ BUILDING CLASS AT TIME OF SALE: chr [1:19028] \"A9\" \"A9\" \"A9\" \"A5\" ...\n $ SALE PRICE                    : num [1:19028] 0 0 0 0 1630000 1630000 0 0 1200000 0 ...\n $ SALE DATE                     : POSIXct[1:19028], format: \"2019-04-23\" \"2019-02-27\" ...\n - attr(*, \"na.action\")= 'omit' Named int [1:4224] 177 178 182 183 186 187 189 197 200 201 ...\n  ..- attr(*, \"names\")= chr [1:4224] \"177\" \"178\" \"182\" \"183\" ...\n```\n:::\n\n```{.r .cell-code}\n# statics of dataset\nsummary(new_brooklyn2019)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   BOROUGH          RESIDENTIAL UNITS COMMERCIAL UNITS  TOTAL UNITS     \n Length:19028       Min.   :  0.000   Min.   :  0.00   Min.   :  0.000  \n Class :character   1st Qu.:  1.000   1st Qu.:  0.00   1st Qu.:  1.000  \n Mode  :character   Median :  2.000   Median :  0.00   Median :  2.000  \n                    Mean   :  2.363   Mean   :  0.21   Mean   :  2.573  \n                    3rd Qu.:  2.000   3rd Qu.:  0.00   3rd Qu.:  2.000  \n                    Max.   :826.000   Max.   :210.00   Max.   :833.000  \n LAND SQUARE FEET GROSS SQUARE FEET   YEAR BUILT  \n Min.   :     0   Min.   :     0    Min.   :1800  \n 1st Qu.:  1172   1st Qu.:   940    1st Qu.:1915  \n Median :  2000   Median :  1992    Median :1930  \n Mean   :  2514   Mean   :  3039    Mean   :1945  \n 3rd Qu.:  2500   3rd Qu.:  2925    3rd Qu.:1985  \n Max.   :970000   Max.   :942992    Max.   :2020  \n BUILDING CLASS AT TIME OF SALE   SALE PRICE       \n Length:19028                   Min.   :        0  \n Class :character               1st Qu.:        0  \n Mode  :character               Median :   515000  \n                                Mean   :  1057858  \n                                3rd Qu.:   999000  \n                                Max.   :214200000  \n   SALE DATE                     \n Min.   :2019-01-01 00:00:00.00  \n 1st Qu.:2019-04-06 18:00:00.00  \n Median :2019-06-28 00:00:00.00  \n Mean   :2019-07-03 18:11:30.18  \n 3rd Qu.:2019-10-01 00:00:00.00  \n Max.   :2019-12-31 00:00:00.00  \n```\n:::\n\n```{.r .cell-code}\n# merge all sub-datasets\nfinal_dataframe <- data.frame()  # define a dataframe\nfilename <- list.files(\"Assignment_1_LujiaLi_folder\")   # names of all .xlsx files\nfor (i in filename){\n  dataframe <- read_excel(gsub(\" \", \"\", paste(\"Assignment_1_LujiaLi_folder/\", i)), skip = 6)\n  colnames(dataframe) <- colnames(dataframe) %>% \n    gsub(\"\\r\", \"\", .) %>%    # delete the special character \"\\r\" in column names\n    gsub(\"\\n\", \" \", .) %>%   # replace the special character \"\\n\" with space in column names\n    gsub(\" $\",\"\",. ,perl = T) %>%  # delete the space at the tail of column names\n    gsub(\"  \",\" \",. ,perl = T)  # replace the double spaces with single space in column names\n  \n  # remove duplicated rows in dataset\n  dataframe <- distinct(dataframe)\n  \n  # subset dataset\n  # c('BOROUGH','RESIDENTIAL UNITS','COMMERCIAL UNITS','TOTAL UNITS','LAND SQUARE FEET','GROSS SQUARE FEET',\n  #   'YEAR BUILT','BUILDING CLASS AT TIME OF SALE','SALE PRICE','SALE DATE') %>%\n  #   subset(dataframe, select = .) -> selected_dataframe\n  \n  selected_dataframe <- subset(dataframe, select = c('BOROUGH','RESIDENTIAL UNITS','COMMERCIAL UNITS','TOTAL UNITS','LAND SQUARE FEET','GROSS SQUARE FEET',\n    'YEAR BUILT','BUILDING CLASS AT TIME OF SALE','SALE PRICE','SALE DATE'))\n  \n  # remove rows with NA values and 0 sale price\n  # 0 sale price means that a transfer of ownership without a cash consideration\n  new_dataframe <- na.omit(selected_dataframe) %>%\n    filter(., `SALE PRICE` != 0)\n  # merge dataframe\n  final_dataframe <- rbind(final_dataframe, new_dataframe)   \n}\nstr(final_dataframe)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [105,958 × 10] (S3: tbl_df/tbl/data.frame)\n $ BOROUGH                       : chr [1:105958] \"3\" \"3\" \"3\" \"3\" ...\n $ RESIDENTIAL UNITS             : num [1:105958] 1 1 1 1 1 2 1 1 1 1 ...\n $ COMMERCIAL UNITS              : num [1:105958] 1 1 0 0 1 0 0 0 0 0 ...\n $ TOTAL UNITS                   : num [1:105958] 2 2 1 1 2 2 1 1 1 1 ...\n $ LAND SQUARE FEET              : num [1:105958] 1342 1342 3867 2708 1160 ...\n $ GROSS SQUARE FEET             : num [1:105958] 1920 1920 2288 730 2320 ...\n $ YEAR BUILT                    : num [1:105958] 1926 1926 1899 1910 1920 ...\n $ BUILDING CLASS AT TIME OF SALE: chr [1:105958] \"S1\" \"S1\" \"A9\" \"A2\" ...\n $ SALE PRICE                    : num [1:105958] 1630000 1630000 1200000 1150000 980000 990000 999000 850000 768000 765000 ...\n $ SALE DATE                     : POSIXct[1:105958], format: \"2019-02-08\" \"2019-02-08\" ...\n - attr(*, \"na.action\")= 'omit' Named int [1:4224] 177 178 182 183 186 187 189 197 200 201 ...\n  ..- attr(*, \"names\")= chr [1:4224] \"177\" \"178\" \"182\" \"183\" ...\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}